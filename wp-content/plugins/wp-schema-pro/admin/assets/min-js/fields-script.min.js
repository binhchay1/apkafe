!function(d){d(window).on("load",function(){d(".aiosrs-pro-custom-field.aiosrs-pro-custom-field-repeater .aiosrs-pro-repeater-table-wrap").hide(),d(".aiosrs-pro-custom-field.aiosrs-pro-custom-field-repeater .bsf-repeater-add-new-btn").hide(),d(".aiosrs-pro-custom-field.aiosrs-pro-custom-field-repeater-target .aiosrs-pro-repeater-table-wrap").hide(),d(".aiosrs-pro-custom-field.aiosrs-pro-custom-field-repeater-target .bsf-repeater-add-new-btn").hide()}),d(document).ready(function(){const t=wp.i18n["__"];d("#wpsp-reset-dialog-confirmation").dialog({dialogClass:"wp-dialog",autoOpen:!1,modal:!0}),d(".wpsp-custom-field-connect, .wpsp-field-close, .bsf-aiosrs-schema-meta-field, image-field-wrap, .aiosrs-pro-custom-field, .wpsp-custom-field-connect").on("click focus change",function(){d(".wpsp-local-fields").each(function(e,s){let i=d(s).find(".wpsp-default-hidden-value").val();var a=d(s).parents(".bsf-aiosrs-schema-row-content").prev();if(i=i.trim())if(d("body").hasClass("block-editor-page")){if(!d(s).find(".wpsp-required-error-field").length){let e;switch(i){case"post_title":e=d(".editor-post-title__input").val();break;case"post_content":e=1<d("p.block-editor-rich-text__editable").text().length?d("p.block-editor-rich-text__editable").text():"";break;case"post_excerpt":e=d(".components-textarea-control__input").val();break;case"featured_img":e="Set featured image"===d(".editor-post-featured-image__toggle").text()?"":d(".components-responsive-wrapper__content").attr("src");break;default:a.removeClass("wpsp-required-error-field")}void 0!==e&&(""!==e?a.removeClass("wpsp-required-error-field"):a.find(".required").length&&a.addClass("wpsp-required-error-field"))}}else a.removeClass("wpsp-required-error-field");else a.find(".required").length&&a.addClass("wpsp-required-error-field")})}),d(".wpsp-show-repeater-field").click(function(){var e=d(this).parents(".aiosrs-pro-custom-field-repeater");e.find(".aiosrs-pro-repeater-table-wrap").show(),e.find(".bsf-repeater-add-new-btn").show(),e.find(".wpsp-show-repeater-field").addClass("bsf-hidden"),e.find(".wpsp-hide-repeater-field").removeClass("bsf-hidden")}),d(".wpsp-hide-repeater-field").click(function(){var e=d(this).parents(".aiosrs-pro-custom-field-repeater");e.find(".aiosrs-pro-repeater-table-wrap").hide(),e.find(".bsf-repeater-add-new-btn").hide(),e.find(".wpsp-hide-repeater-field").addClass("bsf-hidden"),e.find(".wpsp-show-repeater-field").removeClass("bsf-hidden")}),d(".wpsp-show-repeater-target-field").click(function(){var e=d(this).parents(".aiosrs-pro-custom-field-repeater-target");e.find(".aiosrs-pro-repeater-table-wrap").show(),e.find(".bsf-repeater-add-new-btn").show(),e.find(".wpsp-show-repeater-target-field").addClass("bsf-hidden"),e.find(".wpsp-hide-repeater-target-field").removeClass("bsf-hidden")}),d(".wpsp-hide-repeater-target-field").click(function(){var e=d(this).parents(".aiosrs-pro-custom-field-repeater-target");e.find(".aiosrs-pro-repeater-table-wrap").hide(),e.find(".bsf-repeater-add-new-btn").hide(),e.find(".wpsp-hide-repeater-target-field").addClass("bsf-hidden"),e.find(".wpsp-show-repeater-target-field").removeClass("bsf-hidden")}),d('input[type="checkbox"].wpsp-enable-schema-toggle__input').on("click",function(){var e=d(this).parents(".wpsp-enable-schema-markup"),s=d(this).val(),i=e.find(".wpsp-enable-schema-toggle"),e=e.find(".wpsp-enable-schema-toggle__input-hidden");i.hasClass("is-checked")||"1"!==s?(e.attr("value","disabled"),i.removeClass("is-checked")):(e.attr("value","1"),i.addClass("is-checked"))}),d(document).on("change click",function(){function i(e){e.find(".wpsp-connect-field,.wpsp-custom-field").hide(),e.find(".wpsp-specific-field").removeClass("bsf-hidden").show().find("select, textarea, input").val("")}function a(e){e.find(".wpsp-connect-field,.wpsp-specific-field").hide(),e.find(".wpsp-custom-field").removeClass("bsf-hidden").show().find("select, textarea, input").val("")}d(".wpsp-local-fields").find("select, textarea, input").on("change keyup",function(e){if(e.isTrigger&&!d(this).hasClass("wpsp-specific-field")&&!d(this).hasClass("wpsp-date-field"))return!1;var s,e=d(this).parents(".wpsp-local-fields");e.find(".wpsp-default-hidden-value").val(d(this).val()),e.find(".wpsp-default-hidden-fieldtype").val(d(this).parents(".wpsp-parent-field").attr("data-type")),d(this).is("select")&&d(this).parent().hasClass("wpsp-connect-field")&&("create-field"!==(s=d(this).val())&&"specific-field"!==s||("create-field"===s&&(a(e),e.find(".wpsp-default-hidden-fieldtype").val("custom-field")),"specific-field"===s&&(i(e),e.find(".wpsp-default-hidden-fieldtype").val("specific-field")),e.find(".wpsp-default-hidden-value").val("")))}),d("select.bsf-aiosrs-schema-meta-field").change(function(){var e=d(this).parents(".wpsp-local-fields"),s=e.find("select option:selected").html(),i=d(this).val();"none"===i||"create-field"===i||"specific-field"===i?e.find(".bsf-aiosrs-schema-heading-help").attr("title","Please connect any field to apply in the Schema Markup!"):e.find(".bsf-aiosrs-schema-heading-help").attr("title","The "+s+" value in this field will be added to the schema markup of this particular post/page.")}),d(document).on("click",".wpsp-field-close",function(){var e=d(this).parents(".wpsp-local-fields");("specific-field"===e.find(".wpsp-connect-field").removeClass("bsf-hidden").show().find("select").removeAttr("disabled").val()?(e.find(".wpsp-default-hidden-value").val(""),e.find(".wpsp-default-hidden-fieldtype").val("specific-field"),i):(e.find(".wpsp-default-hidden-value").val(""),e.find(".wpsp-default-hidden-fieldtype").val("custom-field"),a))(e)}),d(document).on("click",".wpsp-specific-field-connect, .wpsp-custom-field-connect",function(){var e=d(this).parents(".wpsp-local-fields");let s=e.find(".wpsp-connect-field").removeClass("bsf-hidden").show().find("select").removeAttr("disabled").val();"create-field"!==s&&"specific-field"!==s||(s="none"),e.find(".wpsp-default-hidden-value").val(s),e.find(".wpsp-default-hidden-fieldtype").val("global-field"),e.find(".wpsp-custom-field, .wpsp-specific-field").hide()})}),d(document).on("change input",".bsf-rating-field",function(){var e=d(this).next(".aiosrs-star-rating-wrap"),s=d(this).val();let i=5<s?5:parseInt(s);const a=s===(i=5<s?5:s<0?0:parseInt(s))||5<s||s<0?0:1;e.find("span").each(function(e){d(this).removeClass("dashicons-star-filled dashicons-star-half dashicons-star-empty"),e<i?d(this).addClass("dashicons-star-filled"):e===i&&1==a?d(this).addClass("dashicons-star-half"):d(this).addClass("dashicons-star-empty")})}),d(document).on("click",".aiosrs-star-rating-wrap:not(.disabled) > .aiosrs-star-rating",function(e){e.preventDefault();const s=d(this).data("index");var e=d(this).parent(),i=d(this).parents(".wpsp-local-fields");e.prev(".bsf-rating-field").val(s),i.find(".wpsp-default-hidden-value").val(s),e.find(".aiosrs-star-rating").each(function(e){d(this).removeClass("dashicons-star-filled dashicons-star-half dashicons-star-empty"),e<s?d(this).addClass("dashicons-star-filled"):d(this).addClass("dashicons-star-empty")})}),d(document).on("change",'#aiosrs-pro-custom-fields .aiosrs-pro-custom-field-checkbox input[type="checkbox"]',function(e){e.preventDefault();e=d(this).closest("tr.row").siblings("tr.row");d(this).prop("checked")?e.show():e.hide()}),d('#aiosrs-pro-custom-fields .aiosrs-pro-custom-field-checkbox input[type="checkbox"]').trigger("change"),d(document.body).on("change",'#aiosrs-pro-custom-fields .wpsp-enable-schema-markup input[type="checkbox"].wpsp-enable-schema-toggle__input',function(e){e.preventDefault();e=d(this).parents(".wpsp-enable-schema-markup");d(this).prop("checked")?(e.find(".wpsp-enable-schema-toggle").addClass("is-checked"),e.find(".wpsp-enable-schema-toggle__input-hidden").attr("value","1")):(e.find(".wpsp-enable-schema-toggle").removeClass("is-checked"),e.find(".wpsp-enable-schema-toggle__input-hidden").attr("value","disabled"))}),d('#aiosrs-pro-custom-fields .wpsp-enable-schema-markup input[type="checkbox"].wpsp-enable-schema-toggle__input').trigger("change"),d(document).on("click",".aiosrs-reset-rating",function(e){e.preventDefault();const i=d(this),a=i.closest(".aiosrs-pro-custom-field-rating"),s={action:"aiosrs_reset_post_rating",post_id:i.data("post-id"),schema_id:i.data("schema-id"),nonce:i.data("nonce")};d("#wpsp-reset-dialog-confirmation").dialog({resizable:!1,title:t("Confirmation Required!","wp-schema-pro"),height:"auto",width:400,modal:!0,open(){d(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide();d(this).html('<p><span class="dashicons dashicons-trash"></span> Do you really want to reset current post rating?</p>')},buttons:{Yes(){i.addClass("reset-disabled"),a.find(".spinner").addClass("is-active"),jQuery.ajax({url:ajaxurl,type:"post",dataType:"json",data:s}).success(function(e){var s;void 0!==e.success&&!0===e.success?(s=e["rating-avg"],e=e["review-count"],a.find(".aiosrs-rating").text(s),a.find(".aiosrs-rating-count").text(e),a.find(".aiosrs-star-rating-wrap > .aiosrs-star-rating").removeClass("dashicons-star-filled dashicons-star-half dashicons-star-empty").addClass("dashicons-star-empty")):i.removeClass("reset-disabled"),a.find(".spinner").removeClass("is-active")}),d(this).dialog("close")},Cancel(){d(this).dialog("close")}}}),d("#wpsp-reset-dialog-confirmation").dialog("open")}),d(document).on("change",".multi-select-wrap select",function(){var e=d(this).closest(".multi-select-wrap"),s=e.find("select"),e=e.find('input[type="hidden"]'),s=s.val();null!=s&&0<s.length?e.val(s.join(",")):e.val("")}),d(document).on("click",".aiosrs-pro-meta-fields-tab",function(e){e.preventDefault();e=d(this).data("tab-id");d(this).siblings(".aiosrs-pro-meta-fields-tab").removeClass("active"),d(this).addClass("active"),d("#aiosrs-pro-custom-fields").find(".aiosrs-pro-meta-fields-wrap").removeClass("open"),d("#aiosrs-pro-custom-fields").find("."+e).addClass("open")}),d(document.body).on("change","#aiosrs-pro-custom-fields .wpsp-enable-schema-markup .wpsp-enable-schema-toggle",function(){var e=d(this).parents(".aiosrs-pro-meta-fields-tab"),s=d(this).parents(".inside"),i=e.data("tab-id"),a=s.find(".aiosrs-pro-meta-fields-wrapper").find("."+i).hasClass("is-enable-schema-markup"),e=e.find(".wpsp-enable-schema-toggle").hasClass("is-checked");a||e||s.find(".aiosrs-pro-meta-fields-wrapper").find("."+i).addClass("is-enable-schema-markup")}),d("#aiosrs-pro-custom-fields .wpsp-enable-schema-markup .wpsp-enable-schema-toggle").trigger("change"),d(".wpsp-enable-schema-toggle").on("click",function(){var e=d(this).parents(".aiosrs-pro-meta-fields-tab"),s=d(this).parents(".inside"),e=e.data("tab-id");s.find(".aiosrs-pro-meta-fields-wrapper").find("."+e).toggleClass("is-enable-schema-markup")}),d(".bsf-aiosrs-schema-heading-help").tooltip({content(){return d(this).prop("title")},tooltipClass:"bsf-aiosrs-schema-ui-tooltip",position:{my:"center top",at:"center bottom+10"},hide:{duration:200},show:{duration:200}});let i;window.inputWrapper="",d(document.body).on("click",".image-field-wrap .aiosrs-image-select",function(e){e.preventDefault(),window.inputWrapper=d(this).closest(".bsf-aiosrs-schema-custom-text-wrap, .aiosrs-pro-custom-field-image"),(i=wp.media({button:{text:"Select Image",close:!1},states:[new wp.media.controller.Library({title:t("Select Custom Image","wp-schema-pro"),library:wp.media.query({type:"image"}),multiple:!1})]})).on("select",function(){var e=i.state().get("selection").first().toJSON(),s=window.inputWrapper.find(".image-field-wrap img"),s=(0===s.length?window.inputWrapper.find(".image-field-wrap").append('<a href="#" class="aiosrs-image-select img"><img src="'+e.url+'" /></a>'):s.attr("src",e.url),window.inputWrapper.find(".image-field-wrap").addClass("bsf-custom-image-selected"),window.inputWrapper.find(".single-image-field").val(e.id),window.inputWrapper.parents(".wpsp-local-fields"));s.find(".wpsp-default-hidden-value").val(e.id),s.find(".wpsp-default-hidden-fieldtype").val(window.inputWrapper.parents(".wpsp-parent-field").attr("data-type")),i.close()}),i.open()}),d(document).on("click",".aiosrs-image-remove",function(e){e.preventDefault();e=d(this).closest(".bsf-aiosrs-schema-custom-text-wrap, .aiosrs-pro-custom-field-image");e.find(".image-field-wrap").removeClass("bsf-custom-image-selected"),e.find(".single-image-field").val(""),e.find(".image-field-wrap img").removeAttr("src")}),window.inputWrapper=""})}(jQuery);